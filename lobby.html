<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Bonanza - Lobby</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            min-height: calc(100vh - 40px);
        }

        /* Header */
        .header {
            grid-column: 1 / -1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.4);
            padding: 15px 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

            .header h1 {
                font-size: 1.8rem;
                color: #6bff94;
                text-shadow: 0 0 10px rgba(107, 255, 148, 0.5);
            }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .balance {
            display: flex;
            align-items: center;
            gap: 5px;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .notification-badge {
            position: relative;
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: white;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.3);
        }

        .notification-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        button {
            background: #4a6bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

            button:hover {
                background: #3a5aee;
                transform: translateY(-2px);
            }

        /* Menu Toggle */
        .menu-toggle {
            position: fixed;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            border-radius: 5px;
            width: 40px;
            height: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            z-index: 101;
            transition: all 0.3s ease;
        }

            .menu-toggle:hover {
                background: rgba(0, 0, 0, 0.7);
                transform: scale(1.05);
            }

            .menu-toggle span {
                display: block;
                width: 22px;
                height: 2px;
                background: white;
                border-radius: 1px;
                transition: all 0.3s ease;
            }

            .menu-toggle.active span:nth-child(1) {
                transform: translateY(6px) rotate(45deg);
            }

            .menu-toggle.active span:nth-child(2) {
                opacity: 0;
            }

            .menu-toggle.active span:nth-child(3) {
                transform: translateY(-6px) rotate(-45deg);
            }

        /* Side Menu */
        .side-menu {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100%;
            background: #1e1e2f;
            backdrop-filter: blur(10px);
            padding: 20px;
            overflow-y: auto;
            transition: left 0.3s ease;
            z-index: 100;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }

            .side-menu.open {
                left: 0;
            }

        .menu-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: #27293d;
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            position: relative;
        }

            .menu-header h2 {
                color: #6bff94;
                margin-bottom: 10px;
                font-size: 1.5rem;
            }

        .menu-section {
            margin-bottom: 25px;
            background: #27293d;
            padding: 15px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

            .menu-section:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            }

            .menu-section h3 {
                color: #6bff94;
                margin-bottom: 12px;
                font-size: 1.1rem;
                border-left: 3px solid #6bff94;
                padding-left: 10px;
                display: flex;
                align-items: center;
            }

                .menu-section h3 i {
                    margin-right: 8px;
                }

            .menu-section p {
                margin-bottom: 10px;
                font-size: 0.9rem;
                line-height: 1.4;
                color: rgba(255, 255, 255, 0.8);
            }

        .form-group {
            margin-bottom: 15px;
        }

            .form-group label {
                display: block;
                margin-bottom: 5px;
                font-size: 0.9rem;
                color: rgba(255, 255, 255, 0.9);
            }

            .form-group input, .form-group select, .form-group textarea {
                width: 100%;
                padding: 10px;
                border-radius: 5px;
                border: 1px solid rgba(255, 255, 255, 0.2);
                background: rgba(0, 0, 0, 0.3);
                color: white;
                transition: all 0.3s ease;
            }

                .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
                    outline: none;
                    border-color: #6bff94;
                    box-shadow: 0 0 0 2px rgba(107, 255, 148, 0.3);
                }

        .menu-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 5px;
            background: #4a6bff;
            color: white;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 8px;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
        }

            .menu-btn i {
                margin-right: 8px;
            }

            .menu-btn:hover {
                background: #3a5aee;
                transform: translateY(-2px);
            }

            .menu-btn.success {
                background: #28a745;
            }

                .menu-btn.success:hover {
                    background: #218838;
                }

        .menu-footer {
            margin-top: auto;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .close-sidebar {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            transition: all 0.3s ease;
            z-index: 102;
        }

            .close-sidebar:hover {
                background: rgba(255, 255, 255, 0.1);
            }

        /* Overlay for when menu is open */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 99;
        }

            .overlay.active {
                display: block;
            }

        .balance-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 1.1rem;
            font-weight: bold;
        }

        /* Left Panel - Game Creation */
        .left-panel {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .panel-section {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
        }

            .panel-section h2 {
                margin-bottom: 15px;
                color: #6bff94;
                display: flex;
                align-items: center;
                gap: 10px;
            }

        .game-type-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .game-type-btn {
            padding: 12px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

            .game-type-btn.active {
                background: #4a6bff;
                box-shadow: 0 0 15px rgba(74, 107, 255, 0.5);
            }

        .fee-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .fee-option {
            padding: 10px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

            .fee-option.selected {
                background: #4a6bff;
                box-shadow: 0 0 15px rgba(74, 107, 255, 0.5);
            }

            .fee-option .fee-badge {
                position: absolute;
                top: -5px;
                right: -5px;
                background: #ff6b6b;
                color: white;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                font-size: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
            }

        .invite-section {
            display: none;
        }

        .invite-input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
            color: white;
            margin-bottom: 10px;
        }

        .join-btn {
            background: #6bff94;
            color: #1a2a6c;
            font-weight: bold;
            padding: 15px;
            width: 100%;
            margin-top: 10px;
        }

            .join-btn:hover {
                background: #5ae983;
            }

        .join-btn-disabled {
            background: #ff4757 !important;
            color: white !important;
            cursor: not-allowed !important;
            opacity: 0.7;
        }

            .join-btn-disabled:hover {
                transform: none !important;
                background: #ff4757 !important;
            }

        /* Invited players list */
        .invited-players {
            margin-top: 10px;
            max-height: 150px;
            overflow-y: auto;
        }

        .invited-player {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-bottom: 5px;
        }

        /* Right Panel - Game List */
        .right-panel {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
        }

        .games-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

            .games-header h2 {
                color: #6bff94;
                display: flex;
                align-items: center;
                gap: 10px;
            }

        .refresh-btn {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
        }

        .games-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            overflow-y: auto;
            padding-right: 5px;
            max-height: 60vh;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            transition: all 0.3s;
        }

            .game-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

        .game-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .game-fee {
            font-weight: bold;
            color: #ffcc00;
        }

        .game-id {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .game-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .game-detail {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .detail-value {
            font-weight: bold;
            font-size: 1.2rem;
            color: #6bff94;
        }

        .detail-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .game-status {
            text-align: center;
            padding: 5px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-top: 5px;
        }

        .status-lobby {
            background: rgba(107, 255, 148, 0.2);
            color: #6bff94;
        }

        .status-playing {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
        }

        .join-btn-game {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            background: #6bff94;
            color: #1a2a6c;
            font-weight: bold;
        }

            .join-btn-game:disabled {
                background: rgba(255, 255, 255, 0.1);
                color: rgba(255, 255, 255, 0.5);
                cursor: not-allowed;
            }

        /* Notifications */
        .notifications-panel {
            position: fixed;
            top: 100px;
            right: 20px;
            width: 300px;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 10px;
            padding: 15px;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            display: none;
            backdrop-filter: blur(10px);
        }

            .notifications-panel h3 {
                margin-bottom: 10px;
                color: #6bff94;
            }

        .notification-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }

            .notification-item:hover {
                background: rgba(255, 255, 255, 0.1);
            }

            .notification-item:last-child {
                border-bottom: none;
            }

        /* Messages */
        .message {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 20px;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
            max-width: 80%;
            backdrop-filter: blur(10px);
        }

        .success {
            background: rgba(40, 167, 69, 0.2);
            color: #6bff94;
            border: 1px solid rgba(107, 255, 148, 0.3);
        }

        .error {
            background: rgba(220, 53, 69, 0.2);
            color: #ff6b6b;
            border: 1px solid rgba(255, 107, 107, 0.3);
        }

        /* Game status indicator */
        .game-status-indicator {
            grid-column: 1 / -1;
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .status-icon {
            color: #6bff94;
            font-size: 1.5rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #27293d;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Screenshot upload */
        .screenshot-upload {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

            .screenshot-upload:hover {
                border-color: #6bff94;
            }

            .screenshot-upload i {
                font-size: 2rem;
                margin-bottom: 10px;
                color: #6bff94;
            }

        .screenshot-preview {
            display: none;
            max-width: 100%;
            max-height: 200px;
            margin: 10px auto;
            border-radius: 5px;
        }

        /* Bank selection */
        .bank-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .bank-option {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

            .bank-option:hover {
                background: rgba(255, 255, 255, 0.2);
            }

            .bank-option.selected {
                background: #4a6bff;
                box-shadow: 0 0 15px rgba(74, 107, 255, 0.3);
            }

            .bank-option img {
                width: 40px;
                height: 40px;
                margin-bottom: 5px;
                object-fit: contain;
            }

        /* Responsive adjustments */
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }

            .games-container {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }

            .bank-options {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 600px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .game-type-selector, .fee-selector {
                grid-template-columns: 1fr;
            }

            .games-container {
                grid-template-columns: 1fr;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

            ::-webkit-scrollbar-thumb:hover {
                background: rgba(255, 255, 255, 0.3);
            }
    </style>
</head>
<body>
    <!-- Menu Toggle Button -->
    <div class="menu-toggle" id="menuToggle">
        <span></span>
        <span></span>
        <span></span>
    </div>

    <!-- Side Menu -->
    <div class="side-menu" id="sideMenu">
        <button class="close-sidebar" id="closeSidebar">
            <i class="fas fa-times"></i>
        </button>

        <div class="menu-header">
            <h2><i class="fas fa-user"></i> <span id="menuUsername">Player</span></h2>
            <div class="balance-display">
                <i class="fas fa-coins"></i>
                <span id="balanceAmount">500.00</span> Birr
            </div>
        </div>

        <div class="menu-section">
            <h3><i class="fas fa-wallet"></i> Account</h3>
            <button class="menu-btn" id="depositModalBtn">
                <i class="fas fa-arrow-down"></i> Request Deposit
            </button>
            <button class="menu-btn" id="withdrawModalBtn">
                <i class="fas fa-arrow-up"></i> Request Withdrawal
            </button>
        </div>

        <div class="menu-section">
            <h3><i class="fas fa-cog"></i> Settings</h3>
            <button class="menu-btn" id="soundToggle">
                <i class="fas fa-volume-up"></i> Sound: On
            </button>
            <button class="menu-btn success" id="helpBtn">
                <i class="fas fa-question-circle"></i> How to Play
            </button>
        </div>

        <div class="menu-section">
            <h3><i class="fas fa-sign-out-alt"></i> Account</h3>
            <button class="menu-btn" id="logoutBtnMenu">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>

        <div class="menu-footer">
            <p>Bingo Bonanza v1.0</p>
            <p>Good luck and have fun!</p>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div class="modal" id="depositModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-money-bill-wave"></i> Request Deposit</h3>
                <button class="modal-close" data-modal="depositModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="depositAmount">Amount (Birr)</label>
                <input type="number" id="depositAmount" placeholder="Enter amount" min="10" max="10000">
            </div>
            <div class="form-group">
                <label>Select Bank</label>
                <div class="bank-options">
                    <div class="bank-option" data-bank="telebirr">
                        <i class="fas fa-mobile-alt" style="font-size: 24px;"></i>
                        <div>Telebirr</div>
                    </div>
                    <div class="bank-option" data-bank="cbe">
                        <i class="fas fa-university" style="font-size: 24px;"></i>
                        <div>CBE</div>
                    </div>
                    <div class="bank-option" data-bank="abyssinia">
                        <i class="fas fa-landmark" style="font-size: 24px;"></i>
                        <div>Abyssinia</div>
                    </div>
                    <div class="bank-option" data-bank="other">
                        <i class="fas fa-building" style="font-size: 24px;"></i>
                        <div>Other Bank</div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label>Upload Payment Screenshot</label>
                <div class="screenshot-upload" id="screenshotUpload">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Click to upload screenshot</p>
                    <input type="file" id="screenshotInput" accept="image/*" style="display: none;">
                    <img id="screenshotPreview" class="screenshot-preview">
                </div>
            </div>
            <div class="form-group">
                <label for="transactionReference">Transaction Reference</label>
                <input type="text" id="transactionReference" placeholder="Enter transaction reference number">
            </div>
            <button class="menu-btn success" id="submitDepositBtn">
                <i class="fas fa-paper-plane"></i> Submit Request
            </button>
        </div>
    </div>

    <!-- Withdrawal Modal -->
    <div class="modal" id="withdrawModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-money-bill-wave"></i> Request Withdrawal</h3>
                <button class="modal-close" data-modal="withdrawModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="withdrawAmount">Amount (Birr)</label>
                <input type="number" id="withdrawAmount" placeholder="Enter amount" min="10">
            </div>
            <div class="form-group">
                <label>Select Bank</label>
                <div class="bank-options">
                    <div class="bank-option" data-bank="telebirr">
                        <i class="fas fa-mobile-alt" style="font-size: 24px;"></i>
                        <div>Telebirr</div>
                    </div>
                    <div class="bank-option" data-bank="cbe">
                        <i class="fas fa-university" style="font-size: 24px;"></i>
                        <div>CBE</div>
                    </div>
                    <div class="bank-option" data-bank="abyssinia">
                        <i class="fas fa-landmark" style="font-size: 24px;"></i>
                        <div>Abyssinia</div>
                    </div>
                    <div class="bank-option" data-bank="other">
                        <i class="fas fa-building" style="font-size: 24px;"></i>
                        <div>Other Bank</div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="accountNumber">Account Number</label>
                <input type="text" id="accountNumber" placeholder="Enter your account number">
            </div>
            <div class="form-group">
                <label for="accountName">Account Holder Name</label>
                <input type="text" id="accountName" placeholder="Enter account holder name">
            </div>
            <button class="menu-btn success" id="submitWithdrawBtn">
                <i class="fas fa-paper-plane"></i> Submit Request
            </button>
        </div>
    </div>

    <div class="overlay" id="overlay"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-dice"></i> Bingo Bonanza Lobby</h1>
            <div class="user-info">
                <div class="balance">
                    <i class="fas fa-coins"></i>
                    <span id="userBalance">500.00 Birr</span>
                </div>
                <button class="notification-badge" id="notificationBtn">
                    <i class="fas fa-bell"></i>
                    <span class="notification-count" id="notificationCount" style="display: none;">0</span>
                </button>
                <button id="logoutBtn">Logout</button>
            </div>
        </div>

        <!-- Game status indicator -->
        <div class="game-status-indicator">
            <i class="fas fa-info-circle status-icon"></i>
            <span id="gameStatus">Welcome to Bingo Bonanza! Join a game to start playing.</span>
        </div>

        <!-- Left Panel - Game Creation -->
        <div class="left-panel">
            <div class="panel-section">
                <h2><i class="fas fa-plus-circle"></i> Join Game</h2>

                <div class="game-type-selector">
                    <div class="game-type-btn active" id="publicGameBtn">
                        <i class="fas fa-globe"></i> Public
                    </div>
                    <div class="game-type-btn" id="privateGameBtn">
                        <i class="fas fa-lock"></i> Private
                    </div>
                </div>

                <h3>Entry Fee:</h3>
                <div class="fee-selector">
                    <div class="fee-option selected" data-fee="10">
                        10 Birr
                        <span class="fee-badge">1</span>
                    </div>
                    <div class="fee-option" data-fee="20">
                        20 Birr
                        <span class="fee-badge">2</span>
                    </div>
                    <div class="fee-option" data-fee="50">
                        50 Birr
                        <span class="fee-badge">3</span>
                    </div>
                    <div class="fee-option" data-fee="100">
                        100 Birr
                        <span class="fee-badge">4</span>
                    </div>
                </div>

                <div id="privateGameSection" class="invite-section">
                    <h3>Invite Players:</h3>
                    <input type="text" class="invite-input" id="phoneInput" placeholder="Phone number (251...)">
                    <button id="addPlayerBtn">Add Player</button>
                    <div id="invitedPlayers" class="invited-players"></div>
                </div>

                <button id="joinGameBtn" class="join-btn">Join Game (10 Birr)</button>
            </div>

            <div class="panel-section">
                <h2><i class="fas fa-history"></i> Recent Games</h2>
                <div class="game-detail">
                    <div class="detail-value">0</div>
                    <div class="detail-label">Games Played</div>
                </div>
                <div class="game-detail">
                    <div class="detail-value">0</div>
                    <div class="detail-label">Total Wins</div>
                </div>
            </div>
        </div>

        <!-- Right Panel - Game List -->
        <div class="right-panel">
            <div class="games-header">
                <h2><i class="fas fa-gamepad"></i> Available Games</h2>
                <div class="refresh-btn" id="refreshBtn">
                    <i class="fas fa-sync-alt"></i> Refresh
                </div>
            </div>

            <div class="games-container" id="publicGames">
                <!-- Games will be populated by JavaScript -->
                <div class="game-card">
                    <div class="game-card-header">
                        <div class="game-fee">10 Birr</div>
                        <div class="game-id">ID: BINGO001</div>
                    </div>
                    <div class="game-details">
                        <div class="game-detail">
                            <div class="detail-value">12/50</div>
                            <div class="detail-label">Players</div>
                        </div>
                        <div class="game-detail">
                            <div class="detail-value">120</div>
                            <div class="detail-label">Prize Pool</div>
                        </div>
                    </div>
                    <div class="game-status status-lobby">
                        Waiting for players
                    </div>
                    <button class="join-btn-game">Join Game</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications panel -->
    <div class="notifications-panel" id="notificationsPanel">
        <h3><i class="fas fa-bell"></i> Notifications</h3>
        <div id="notificationsList">
            <p>No notifications</p>
        </div>
    </div>

    <!-- Messages container -->
    <div id="messageContainer"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Game state variables
        let selectedGameType = 'public';
        let selectedEntryFee = 10;
        let invitedPlayers = [];
        let notifications = [];
        let publicGames = [];
        let voiceEnabled = true;
        let isGameInProgress = false;
        let selectedBank = null;
        let screenshotFile = null;

        // User session data
        let sessionId = localStorage.getItem('sessionId');
        let username = localStorage.getItem('username');

        // Check if user is logged in
        if (!sessionId || !username) {
            window.location.href = 'login.html';
        }

        let userBalance = parseFloat(localStorage.getItem('balance')) || 500;
        let userPhone = localStorage.getItem('phone');

        // Set user info in the header
        document.getElementById('userBalance').textContent = userBalance.toFixed(2) + ' Birr';

        // Initialize socket connection
        const socket = io();

        // Socket event listeners
        socket.on('connect', () => {
            console.log('Connected to server');
            loadPublicGames();
            checkForInvitations();
        });

        socket.on('player-count-update', (data) => {
            updateGameInfo(data);
        });

        socket.on('invitation-received', (data) => {
            showNotification(data);
        });

        // Balance update listener
        socket.on('balance-update', (data) => {
            if (data.username === username) {
                // Update the balance
                userBalance = data.balance;

                // Update localStorage
                localStorage.setItem('balance', userBalance);

                // Update UI
                document.getElementById('userBalance').textContent = userBalance.toFixed(2) + ' Birr';
                updateMenuBalance();

                // Show notification
                showMessage('Your balance has been updated!', 'success');
            }
        });

        // Menu functionality
        function toggleMenu() {
            const menuToggle = document.getElementById('menuToggle');
            const sideMenu = document.getElementById('sideMenu');
            const overlay = document.getElementById('overlay');

            if (menuToggle && sideMenu && overlay) {
                menuToggle.classList.toggle('active');
                sideMenu.classList.toggle('open');
                overlay.classList.toggle('active');
            }
        }

        // Update balance display in menu
        function updateMenuBalance() {
            const balanceEl = document.getElementById('balanceAmount');
            if (balanceEl) {
                balanceEl.textContent = userBalance.toFixed(2);
            }
        }

        // Open deposit modal
        function openDepositModal() {
            document.getElementById('depositModal').style.display = 'block';
            document.getElementById('overlay').style.display = 'block';
        }

        // Open withdrawal modal
        function openWithdrawModal() {
            document.getElementById('withdrawModal').style.display = 'block';
            document.getElementById('overlay').style.display = 'block';
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
            // Reset form
            if (modalId === 'depositModal') {
                document.getElementById('depositAmount').value = '';
                document.getElementById('transactionReference').value = '';
                document.getElementById('screenshotPreview').style.display = 'none';
                document.getElementById('screenshotPreview').src = '';
                screenshotFile = null;
                selectedBank = null;
                document.querySelectorAll('.bank-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
            } else if (modalId === 'withdrawModal') {
                document.getElementById('withdrawAmount').value = '';
                document.getElementById('accountNumber').value = '';
                document.getElementById('accountName').value = '';
                selectedBank = null;
                document.querySelectorAll('.bank-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
            }
        }

        // Handle bank selection
        function selectBank(bankElement, bankType) {
            document.querySelectorAll('.bank-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            bankElement.classList.add('selected');
            selectedBank = bankType;
        }

        // Handle screenshot upload
        function handleScreenshotUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const preview = document.getElementById('screenshotPreview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    screenshotFile = file;
                };
                reader.readAsDataURL(file);
            }
        }

        // Request deposit
        async function requestDeposit() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            const reference = document.getElementById('transactionReference').value;

            if (!amount || amount <= 0) {
                showMessage('Please enter a valid amount.', 'error');
                return;
            }

            if (!selectedBank) {
                showMessage('Please select a bank.', 'error');
                return;
            }

            if (!reference) {
                showMessage('Please enter transaction reference.', 'error');
                return;
            }

            if (!screenshotFile) {
                showMessage('Please upload payment screenshot.', 'error');
                return;
            }

            try {
                // Create form data for file upload
                const formData = new FormData();
                formData.append('sessionId', sessionId);
                formData.append('username', username);
                formData.append('amount', amount);
                formData.append('bank', selectedBank);
                formData.append('reference', reference);
                formData.append('screenshot', screenshotFile);

                const response = await fetch('/api/request-deposit', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    showMessage('Deposit request submitted successfully! It will be processed after admin verification.', 'success');
                    closeModal('depositModal');
                } else {
                    showMessage('Error: ' + data.error, 'error');
                }
            } catch (error) {
                console.error('Deposit request error:', error);
                showMessage('Network error. Please try again.', 'error');
            }
        }

        // Request withdrawal
        async function requestWithdrawal() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const accountNumber = document.getElementById('accountNumber').value;
            const accountName = document.getElementById('accountName').value;

            if (!amount || amount <= 0) {
                showMessage('Please enter a valid amount.', 'error');
                return;
            }

            if (amount > userBalance) {
                showMessage('Insufficient balance for withdrawal.', 'error');
                return;
            }

            if (!selectedBank) {
                showMessage('Please select a bank.', 'error');
                return;
            }

            if (!accountNumber) {
                showMessage('Please enter account number.', 'error');
                return;
            }

            if (!accountName) {
                showMessage('Please enter account holder name.', 'error');
                return;
            }

            try {
                const response = await fetch('/api/request-withdrawal', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        sessionId: sessionId,
                        username: username,
                        amount: amount,
                        bank: selectedBank,
                        accountNumber: accountNumber,
                        accountName: accountName
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    showMessage('Withdrawal request submitted successfully! It will be processed within 24 hours.', 'success');

                    // Update balance immediately (will be reverted if rejected)
                    userBalance -= amount;
                    localStorage.setItem('balance', userBalance);
                    document.getElementById('userBalance').textContent = userBalance.toFixed(2) + ' Birr';
                    updateMenuBalance();

                    closeModal('withdrawModal');
                } else {
                    showMessage('Error: ' + data.error, 'error');
                }
            } catch (error) {
                console.error('Withdrawal request error:', error);
                showMessage('Network error. Please try again.', 'error');
            }
        }

        // Toggle sound settings
        function toggleSound() {
            const soundToggle = document.getElementById('soundToggle');
            voiceEnabled = !voiceEnabled;

            if (soundToggle) {
                soundToggle.innerHTML = `<i class="fas fa-volume-${voiceEnabled ? 'up' : 'mute'}"></i> Sound: ${voiceEnabled ? 'On' : 'Off'}`;
            }

            localStorage.setItem('voiceEnabled', voiceEnabled);
        }

        // Show help information
        function showHelp() {
            alert("How to Play Bingo Bonanza:\n\n1. Join or create a game\n2. Select your bingo card type\n3. Mark numbers as they're called\n4. Click BINGO when you complete a line\n5. Win prizes based on the game's entry fee!\n\nGood luck!");
        }

        // Initialize menu functionality
        function initMenu() {
            // Set user info in menu
            const menuUsernameEl = document.getElementById('menuUsername');
            if (menuUsernameEl) {
                menuUsernameEl.textContent = username;
            }

            updateMenuBalance();

            // Set up event listeners
            const menuToggle = document.getElementById('menuToggle');
            const closeSidebar = document.getElementById('closeSidebar');
            const overlay = document.getElementById('overlay');
            const soundToggle = document.getElementById('soundToggle');
            const helpBtn = document.getElementById('helpBtn');
            const logoutBtnMenu = document.getElementById('logoutBtnMenu');
            const depositModalBtn = document.getElementById('depositModalBtn');
            const withdrawModalBtn = document.getElementById('withdrawModalBtn');

            if (menuToggle) menuToggle.addEventListener('click', toggleMenu);
            if (closeSidebar) closeSidebar.addEventListener('click', toggleMenu);
            if (overlay) overlay.addEventListener('click', () => {
                toggleMenu();
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            });
            if (soundToggle) soundToggle.addEventListener('click', toggleSound);
            if (helpBtn) helpBtn.addEventListener('click', showHelp);
            if (logoutBtnMenu) logoutBtnMenu.addEventListener('click', logout);
            if (depositModalBtn) depositModalBtn.addEventListener('click', openDepositModal);
            if (withdrawModalBtn) withdrawModalBtn.addEventListener('click', openWithdrawModal);

            // Modal close buttons
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', () => {
                    const modalId = btn.getAttribute('data-modal');
                    closeModal(modalId);
                });
            });

            // Bank selection
            document.querySelectorAll('.bank-option').forEach(opt => {
                opt.addEventListener('click', () => {
                    selectBank(opt, opt.getAttribute('data-bank'));
                });
            });

            // Screenshot upload
            document.getElementById('screenshotUpload').addEventListener('click', () => {
                document.getElementById('screenshotInput').click();
            });
            document.getElementById('screenshotInput').addEventListener('change', handleScreenshotUpload);

            // Form submissions
            document.getElementById('submitDepositBtn').addEventListener('click', requestDeposit);
            document.getElementById('submitWithdrawBtn').addEventListener('click', requestWithdrawal);

            // Initialize sound setting
            const savedVoiceSetting = localStorage.getItem('voiceEnabled');
            if (savedVoiceSetting !== null) {
                voiceEnabled = savedVoiceSetting === 'true';
            }
            toggleSound(); // Set initial button state
        }

        // Update game information for waiting players
        function updateGameInfo(data) {
            const gameStatus = document.getElementById('gameStatus');
            isGameInProgress = data.gameStatus === 'playing';

            // Update join button based on game status
            updateJoinButton();

            if (data.gameStatus === 'playing') {
                gameStatus.textContent = `Game in progress - ${data.playerCount} players. Current number: ${data.currentNumber || '--'}`;
            } else if (data.gameStatus === 'lobby') {
                gameStatus.textContent = `New game starting soon - ${data.playerCount} players waiting`;
            } else {
                gameStatus.textContent = 'Welcome to Bingo Bonanza! Join a game to start playing.';
            }
        }

        // Update join button based on game status
        function updateJoinButton() {
            const joinBtn = document.getElementById('joinGameBtn');

            if (selectedGameType === 'public') {
                if (isGameInProgress) {
                    joinBtn.textContent = 'Game in Progress - Wait';
                    joinBtn.classList.add('join-btn-disabled');
                    joinBtn.disabled = true;
                } else {
                    joinBtn.textContent = `Join Game (${selectedEntryFee} Birr)`;
                    joinBtn.classList.remove('join-btn-disabled');
                    joinBtn.disabled = false;
                }
            } else {
                joinBtn.textContent = `Create Private Game (${selectedEntryFee} Birr)`;
                joinBtn.classList.remove('join-btn-disabled');
                joinBtn.disabled = false;
            }
        }

        // Game type selection
        function selectGameType(type) {
            selectedGameType = type;
            document.getElementById('publicGameBtn').classList.toggle('active', type === 'public');
            document.getElementById('privateGameBtn').classList.toggle('active', type === 'private');

            const privateSection = document.getElementById('privateGameSection');
            const joinBtn = document.getElementById('joinGameBtn');

            if (type === 'public') {
                privateSection.style.display = 'none';
                updateJoinButton();
            } else {
                privateSection.style.display = 'block';
                joinBtn.textContent = `Create Private Game (${selectedEntryFee} Birr)`;
                joinBtn.classList.remove('join-btn-disabled');
                joinBtn.disabled = false;
            }
        }

        // Entry fee selection
        function selectEntryFee(fee) {
            selectedEntryFee = fee;
            document.querySelectorAll('.fee-option').forEach(opt => {
                opt.classList.toggle('selected', parseInt(opt.dataset.fee) === fee);
            });

            const joinBtn = document.getElementById('joinGameBtn');
            if (selectedGameType === 'public') {
                updateJoinButton();
            } else {
                joinBtn.textContent = `Create Private Game (${selectedEntryFee} Birr)`;
            }
        }

        // Add invited player
        function addInvitedPlayer() {
            const phoneInput = document.getElementById('phoneInput');
            const phone = phoneInput.value.trim();

            if (!phone) {
                showMessage('Please enter a phone number', 'error');
                return;
            }

            // Basic phone validation
            if (!/^\+?[0-9]{10,15}$/.test(phone)) {
                showMessage('Please enter a valid phone number', 'error');
                return;
            }

            // Check if phone is already invited
            if (invitedPlayers.includes(phone)) {
                showMessage('This phone number is already invited', 'error');
                return;
            }

            // Check if inviting self
            if (phone === userPhone) {
                showMessage('You cannot invite yourself', 'error');
                return;
            }

            invitedPlayers.push(phone);
            updateInvitedPlayersList();
            phoneInput.value = '';
            showMessage(`Added ${phone} to invited players`, 'success');
        }

        // Update invited players list
        function updateInvitedPlayersList() {
            const list = document.getElementById('invitedPlayers');

            if (invitedPlayers.length === 0) {
                list.innerHTML = '<p>No players invited yet</p>';
                return;
            }

            list.innerHTML = '';
            invitedPlayers.forEach(phone => {
                const playerEl = document.createElement('div');
                playerEl.className = 'invited-player';
                playerEl.innerHTML = `
                                <span>${phone}</span>
                                <button onclick="removeInvitedPlayer('${phone}')">Remove</button>
                            `;
                list.appendChild(playerEl);
            });
        }

        // Remove invited player
        function removeInvitedPlayer(phone) {
            invitedPlayers = invitedPlayers.filter(p => p !== phone);
            updateInvitedPlayersList();
            showMessage(`Removed ${phone} from invited players`, 'success');
        }

        // Create or join game
        async function joinGame() {
            try {
                // For private games, validate that we have invited players
                if (selectedGameType === 'private' && invitedPlayers.length === 0) {
                    showMessage('Please invite at least one player for a private game', 'error');
                    return;
                }

                const response = await fetch('/api/create-game', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        entryFee: selectedEntryFee,
                        gameType: selectedGameType,
                        invitedPlayers: selectedGameType === 'private' ? invitedPlayers : [],
                        creator: username,
                        sessionId: sessionId
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    if (data.existing) {
                        showMessage(`Joined existing ${selectedEntryFee} Birr game!`, 'success');
                        // Store game data and redirect
                        localStorage.setItem('currentGame', JSON.stringify({
                            id: data.gameId,
                            entryFee: selectedEntryFee,
                            gameType: selectedGameType
                        }));
                        window.location.href = 'game.html';
                    } else {
                        showMessage(`Created new ${selectedEntryFee} Birr ${selectedGameType} game!`, 'success');
                        // Store game data and redirect
                        localStorage.setItem('currentGame', JSON.stringify({
                            id: data.gameId,
                            entryFee: selectedEntryFee,
                            gameType: selectedGameType
                        }));
                        window.location.href = 'game.html';
                    }
                } else {
                    showMessage(data.error || 'Failed to join game', 'error');
                }
            } catch (error) {
                console.error('Error joining game:', error);
                showMessage('Network error. Please try again.', 'error');
            }
        }

        // Join an existing game
        async function joinGameFromList(gameId, entryFee) {
            // Check if user has sufficient balance (client-side check)
            const currentBalance = parseFloat(userBalance);

            if (currentBalance < entryFee) {
                showMessage(`Insufficient balance to join this ${entryFee} Birr game. Please deposit more funds.`, 'error');
                return;
            }

            try {
                // Check if game is still available with session validation
                const response = await fetch('/api/join-game', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        gameId: gameId,
                        entryFee: entryFee,
                        sessionId: sessionId,
                        username: username
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    // Check if game is still in lobby
                    const gameResponse = await fetch('/api/games');
                    const games = await gameResponse.json();
                    const game = games.find(g => g.id === gameId);

                    if (game && game.gameStatus === 'lobby') {
                        showMessage(`Joined ${entryFee} Birr game!`, 'success');

                        // Store game data and redirect
                        localStorage.setItem('currentGame', JSON.stringify({
                            id: gameId,
                            entryFee: entryFee,
                            gameType: 'public'
                        }));

                        window.location.href = 'game.html';
                    } else {
                        showMessage('This game has already started. Please wait for the next round or join another game.', 'error');
                    }
                } else {
                    showMessage(data.error || 'Failed to join game', 'error');
                }
            } catch (error) {
                console.error('Error joining game:', error);
                showMessage('Network error. Please try again.', 'error');
            }
        }

        // Load public games
        async function loadPublicGames() {
            try {
                const response = await fetch('/api/games');
                const games = await response.json();

                publicGames = games;
                displayPublicGames(games);

                // Update game status indicator
                const statusEl = document.getElementById('gameStatus');
                if (games.length > 0) {
                    const activeGames = games.filter(game => game.gameStatus === 'playing');
                    const lobbyGames = games.filter(game => game.gameStatus === 'lobby');

                    if (activeGames.length > 0) {
                        statusEl.textContent = `${activeGames.length} game(s) in progress. New players must wait for the next round.`;
                        isGameInProgress = true;
                    } else if (lobbyGames.length > 0) {
                        statusEl.textContent = `${lobbyGames.length} game(s) waiting for players. You can join now!`;
                        isGameInProgress = false;
                    } else {
                        statusEl.textContent = 'No games available. Join a new one!';
                        isGameInProgress = false;
                    }
                } else {
                    statusEl.textContent = 'No games available. Join a new one!';
                    isGameInProgress = false;
                }

                // Update join button based on game status
                updateJoinButton();
            } catch (error) {
                console.error('Error loading games:', error);
                document.getElementById('publicGames').innerHTML = '<p>Error loading games. Please refresh.</p>';
            }
        }

        // Display public games
        function displayPublicGames(games) {
            const container = document.getElementById('publicGames');

            if (games.length === 0) {
                container.innerHTML = '<p>No public games available. Join a new one!</p>';
                return;
            }

            container.innerHTML = '';
            games.forEach(game => {
                const gameEl = document.createElement('div');
                gameEl.className = 'game-card';

                if (game.gameStatus === 'playing') {
                    gameEl.classList.add('game-active');
                }

                gameEl.innerHTML = `
                                        <div class="game-card-header">
                                            <div class="game-fee">${game.entryFee} Birr</div>
                                            <div class="game-id">ID: ${game.id}</div>
                                        </div>
                                        <div class="game-details">
                                            <div class="game-detail">
                                                <div class="detail-value">${game.playerCount}/${game.maxPlayers}</div>
                                                <div class="detail-label">Players</div>
                                            </div>
                                            <div class="game-detail">
                                                <div class="detail-value">${game.prizePool}</div>
                                                <div class="detail-label">Prize Pool</div>
                                            </div>
                                        </div>
                                        <div class="game-status ${game.gameStatus === 'playing' ? 'status-playing' : 'status-lobby'}">
                                            ${game.gameStatus === 'playing' ? 'Game in progress' : 'Waiting for players'}
                                        </div>
                                        <button class="join-btn-game" onclick="joinGameFromList(${game.id}, ${game.entryFee})"
                                                ${game.gameStatus === 'playing' || game.playerCount >= game.maxPlayers ? 'disabled' : ''}>
                                            ${game.gameStatus === 'playing' ? 'Game in Progress' :
                        game.playerCount >= game.maxPlayers ? 'Game Full' : 'Join Game'}
                                        </button>
                                    `;
                container.appendChild(gameEl);
            });
        }

        // Check for invitations
        function checkForInvitations() {
            if (!userPhone) return;

            fetch('/api/check-invitations', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    phone: userPhone,
                    sessionId: sessionId,
                    username: username
                })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.invitations.length > 0) {
                        showNotifications(data.invitations);
                    }
                })
                .catch(error => {
                    console.error('Error checking invitations:', error);
                });
        }

        // Show notifications
        function showNotifications(invitations) {
            notifications = invitations;
            const countEl = document.getElementById('notificationCount');
            countEl.textContent = invitations.length;
            countEl.style.display = 'inline-block';

            const listEl = document.getElementById('notificationsList');
            listEl.innerHTML = '';

            if (invitations.length === 0) {
                listEl.innerHTML = '<p>No notifications</p>';
                return;
            }

            invitations.forEach(invite => {
                const itemEl = document.createElement('div');
                itemEl.className = 'notification-item';
                itemEl.innerHTML = `
                                        <div><strong>${invite.inviter}</strong> invited you to a ${invite.entryFee} Birr game!</div>
                                        <small>Click to join</small>
                                    `;
                itemEl.onclick = () => acceptInvitation(invite.gameId);
                listEl.appendChild(itemEl);
            });
        }

        // Show a single notification
        function showNotification(invite) {
            notifications.push(invite);
            showNotifications(notifications);
        }

        // Accept invitation
        function acceptInvitation(gameId) {
            if (typeof socket !== 'undefined') {
                socket.emit('accept-invitation', {
                    gameId,
                    phone: userPhone,
                    sessionId: sessionId,
                    username: username
                });
            }

            // Store game data and redirect
            const invite = notifications.find(i => i.gameId === gameId);
            localStorage.setItem('currentGame', JSON.stringify({
                id: gameId,
                entryFee: invite.entryFee,
                gameType: 'private'
            }));

            window.location.href = 'game.html';
        }

        // Toggle notifications panel
        function toggleNotifications() {
            const panel = document.getElementById('notificationsPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Show message
        function showMessage(text, type) {
            const container = document.getElementById('messageContainer');
            const messageEl = document.createElement('div');
            messageEl.className = `message ${type}`;
            messageEl.textContent = text;
            container.appendChild(messageEl);

            // Auto remove after 5 seconds
            setTimeout(() => {
                messageEl.remove();
            }, 5000);
        }

        // Logout function
        function logout() {
            fetch('/api/logout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ sessionId: sessionId })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Clear local storage
                        localStorage.removeItem('sessionId');
                        localStorage.removeItem('username');
                        localStorage.removeItem('balance');
                        localStorage.removeItem('phone');
                        localStorage.removeItem('currentGame');

                        // Redirect to login page
                        window.location.href = 'login.html';
                    }
                })
                .catch(error => {
                    console.error('Logout error:', error);
                    // Still clear local storage and redirect
                    localStorage.clear();
                    window.location.href = 'login.html';
                });
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            // Set up logout button
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', logout);
            }

            // Set up game type buttons
            document.getElementById('publicGameBtn').addEventListener('click', () => selectGameType('public'));
            document.getElementById('privateGameBtn').addEventListener('click', () => selectGameType('private'));

            // Set up fee options
            document.querySelectorAll('.fee-option').forEach(option => {
                option.addEventListener('click', () => {
                    selectEntryFee(parseInt(option.dataset.fee));
                });
            });

            // Set up add player button
            document.getElementById('addPlayerBtn').addEventListener('click', addInvitedPlayer);

            // Set up join game button
            document.getElementById('joinGameBtn').addEventListener('click', joinGame);

            // Set up notification button
            document.getElementById('notificationBtn').addEventListener('click', toggleNotifications);

            // Set up refresh button
            document.getElementById('refreshBtn').addEventListener('click', loadPublicGames);

            // Initialize menu
            initMenu();

            // Load initial data
            loadPublicGames();
            checkForInvitations();

            // Set up periodic refresh of games list
            setInterval(loadPublicGames, 5000);
        });
    </script>
</body>
</html>